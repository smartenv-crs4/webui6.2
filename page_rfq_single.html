<!DOCTYPE html>
<!--[if IE 8]>
<html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9]>
<html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en"> <!--<![endif]-->
<head>
    <title>RFQs Page - Cagliari Port 2020</title>

    <!-- Meta -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Favicon -->
    <link rel="shortcut icon" href="favicon.ico">

    <!-- Web Fonts
<link rel='stylesheet' type='text/css' href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,600&amp;subset=cyrillic,latin'>-->

    <!-- CSS Global Compulsory -->
    <link rel="stylesheet" href="assets/plugins/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/style.css">

    <!-- CSS Header and Footer -->
    <link rel="stylesheet" href="assets/css/headers/header-default.css">
    <link rel="stylesheet" href="assets/css/footers/footer-v1.css">

    <!-- CSS Implementing Plugins -->
    <link rel="stylesheet" href="assets/plugins/animate.css">
    <link rel="stylesheet" href="assets/plugins/line-icons/line-icons.css">
    <link rel="stylesheet" href="assets/plugins/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="assets/plugins/scrollbar/css/jquery.mCustomScrollbar.css">
    <link href="http://cdnjs.cloudflare.com/ajax/libs/x-editable/1.5.0/bootstrap3-editable/css/bootstrap-editable.css"
          rel="stylesheet"/>
    <link rel="stylesheet" href="assets/css/jquery.jgrowl.min.css">

    <!-- CSS Page Style -->
    <link rel="stylesheet" href="assets/css/pages/profile.css">

    <link rel="stylesheet" href="assets/plugins/sky-forms-pro/skyforms/css/sky-forms.css">
    <link rel="stylesheet" href="assets/plugins/sky-forms-pro/skyforms/custom/custom-sky-forms.css">


    <!-- CSS Theme -->
    <link rel="stylesheet" href="assets/css/theme-skins/dark.css" id="style_color">
    <link rel="stylesheet" href="assets/css/theme-colors/dark-red.css">

    <!-- CSS Customization -->
    <link rel="stylesheet" href="assets/css/custom.css">
    <link rel="stylesheet" href="assets/css/custom_rfq.css">

</head>

<body>

<div class="wrapper">
    <!--=== Header ===-->
    <div id="header_p"></div>
    <!--=== End Header ===-->

    <!--=== Profile ===-->
    <div class="container content profile">
        <div class="row">

            <!--Left Sidebar-->
            <div id="sidebar" class="col-md-3" style="display: none;">

            </div>
            <!--End Left Sidebar-->
            <!-- Profile Content -->
            <div class="col-md-9">
                <div class="profile-body">
                    <div class="row">
                        <!--Alert-->
                        <div class="sm-margin-bottom-30 rfq-container">
                            <div class="panel-heading-v2 overflow-h">
                                <h2 class="heading-xs pull-left"><i class="fa fa-paper-plane fa-fw"></i> RFQs Inbox</h2>
                                <div style="text-align: center">
                                    <div class="inbox-rfq-header" style="display: inline-block;">
                                        <strong id="inbox-rfq-header-name" class="" style=""></strong>
                                    </div>
                                    <span id="rfq-status-header" class="pull-right"></span>
                                    <a id="rfq-settings-header" href="#"><i class="fa fa-cog pull-right"></i></a>
                                </div>

                            </div>
                            <hr>
                            <div class="panel panel-profile">


                                <div id="inbox-rfqs-container">

                                </div>
                            </div>
                        </div>
                    </div>
                    <!--End Alert-->

                </div><!--/end row-->

                <hr>


            </div>
            <!-- End Profile Content -->
        </div>
    </div><!--/container-->
    <!--=== End Profile ===-->

    <!--=== Footer Version 1 ===-->
    <div id="footer_p" ></div>

    <!--=== End Footer Version 1 ===-->
</div><!--/wrapper-->

<!-- JS Global Compulsory -->
<script type="text/javascript" src="assets/plugins/jquery/jquery.min.js"></script>
<script type="text/javascript" src="assets/plugins/jquery/jquery-migrate.min.js"></script>
<script type="text/javascript" src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>
<!-- JS Implementing Plugins -->
<script type="text/javascript" src="assets/plugins/smoothScroll.js"></script>
<script type="text/javascript" src="assets/plugins/counter/waypoints.min.js"></script>
<script type="text/javascript" src="assets/plugins/counter/jquery.counterup.min.js"></script>
<!--<script type="text/javascript" src="assets/plugins/sky-forms-pro/skyforms/js/jquery-ui.min.js"></script>
<script type="text/javascript" src="assets/plugins/sky-forms-pro/skyforms/js/jquery.validate.min.js"></script>-->
<script type="text/javascript" src="assets/plugins/scrollbar/js/jquery.mCustomScrollbar.concat.min.js"></script>

<!-- JS Translation -->
<script src="assets/js/translations/translation.js"></script>
<script type="text/javascript" src="assets/js/plugins/i18next.min.js"></script>
<script type="text/javascript" src="assets/js/plugins/jquery-i18next.min.js"></script>

<!-- JS Customization -->
<script type="text/javascript" src="assets/js/sidebar.js"></script>
<script type="text/javascript" src="assets/js/custom.js"></script>
<!-- JS Page Level -->
<script type="text/javascript" src="assets/js/app.js"></script>
<script type="text/javascript" src="assets/js/plugins/datepicker.js"></script>
<!--<script type="text/javascript" src="assets/js/plugins/style-switcher.js"></script>-->
<script type="text/javascript" src="assets/js/common_header.js"></script>
<script type="text/javascript" src="assets/js/footer.js"></script>

<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.5/handlebars.min.js"></script>

<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/x-editable/1.5.1/bootstrap3-editable/js/bootstrap-editable.min.js"></script>
<script type="text/javascript" src="assets/js/plugins/jquery.jgrowl.min.js"></script>
<script src="http://cdn.jsdelivr.net/jquery.scrollto/2.1.2/jquery.scrollTo.min.js"></script>


<script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
<script type="text/javascript" src="assets/js/custom_rfq.js"></script>

<script type="text/javascript" src="assets/js/utils.js"></script>


<script type="text/javascript">

    jQuery(document).ready(function () {
        App.init();

        //App.initCounter();
        //App.initScrollBar();
        //Datepicker.initDatepicker();
        //StyleSwitcher.initStyleSwitcher();
        $("#sidebar").show();
        getConversationRequestsAndMessages();

    });
</script>
<!--[if lt IE 9]>
<script src="assets/plugins/respond.js"></script>
<script src="assets/plugins/html5shiv.js"></script>
<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<script src="assets/plugins/sky-forms-pro/skyforms/js/sky-forms-ie8.js"></script>
<![endif]-->

<!--[if lt IE 10]>
<script src="assets/plugins/sky-forms-pro/skyforms/js/jquery.placeholder.min.js"></script>
<![endif]-->
<!--Template RFQ Requests and Messages -->
<script id="inbox_rfq_requests_messages" type="text/x-handlebars-template">
    {{#if completed}}
    {{#if_eq currentUser 'customer'}}
    <div class="writeval alert alert-success fade in">
        <!-- <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>-->
        <strong>RFQ </strong>&nbsp; <strong data-i18n="rfq.close"></strong>!&nbsp; <a class="alert-link" href="javascript:window.location.href='evaluation.html?convId={{_id}}'" data-i18n="rfq.sendeval"></a>
    </div>
{{/if_eq}}{{/if}}
    <div class="col-sm-6 chat-panel panel panel-default	">
        <div class="panel-heading overflow-h">
            <i class="fa fa-tasks fa-fw"></i>
            <span data-i18n="rfq.requests"></span>
        </div>
        <div class="panel-group acc-v1" id="accordion-panel">
            {{#each requests}}
            {{> request completed=../completed expired=../expired currentUser=../currentUser customer=../customer
            supplier=../supplier _id_c=../_id munits=../measureunits}}

            {{/each}}
        </div>
    </div>
    <div class="col-sm-6 chat-panel panel panel-default">
        <div class="panel-heading overflow-h">
            <i class="fa fa-comments fa-fw"></i> <span data-i18n="rfq.messages"></span>

        </div>
        <!-- /.panel-heading -->

        <div class="panel-body cont-list-messages">
            <ul id="rfq-list-messages" class="chat">
                {{#each messages}}
                {{#if automatic}}
                {{> message-auto}}
                {{else}}
                {{> message}}
                {{/if}}

                {{/each}}
            </ul>
        </div>
        <!-- /.panel-body -->
        <div class="panel-footer">
            <div class="input-group">
                <input id="rfq-input-msg" type="text" class="form-control input-sm"
                       data-i18n="[placeholder]rfq.writeMessage">
    <span class="input-group-btn">
    <button class="btn btn-warning btn-sm" id="btn-chat" onclick="sendMessage('{{_id}}')" data-i18n="buttons.send">
    </button>
    </span>
            </div>
        </div>




        <!-- /.panel-footer -->
    </div>



</script>

<!--End Template RFQ Inbox -->


<script id="request-partial" type="text/x-handlebars-template">
    <div id="rfq-panel-{{_id}}" data-value="{{inc @index}}" class="rfq panel panel-default">
        <div class="panel-heading">
            <h4 class="panel-title">
                <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion-panel"
                   href="#collapse-{{inc @index}}">
                    {{inc @index}} - RFQ <span data-i18n="rfq.requestSubject"></span>: {{product.name}}
                    {{#if_eq_or_eq status 'pending' status 'acceptedByS'}}
                    <i class="fa fa-exclamation-circle fa-lg pull-right"></i>
                    {{/if_eq_or_eq}}
                    {{#if_eq_or_eq status 'rejectedByC' status 'rejectedByS'}}
                    <i class="fa fa-times-circle fa-lg pull-right"></i>
                    {{/if_eq_or_eq}}
                    {{#if_eq status 'acceptedByC'}}
                    <i class="fa fa-check-circle fa-lg pull-right"></i>
                    {{/if_eq}}
                </a>

            </h4>
        </div>
        <div id="collapse-{{inc @index}}" class="panel-collapse collapse">
            <div class="alert-blocks service-block-u" id="request-{{_id}}">
                <img class="rounded-x" src="http://seidue.crs4.it:3015/{{product._id}}/{{product.images.[0].name}}_o.jpg"
                onError="this.onerror=null;this.src='assets/img/team/img1-md.jpg'" alt="">
             <!--   <img class="rounded-x" src={{productLogo product}} alt="">-->
                <strong class="service-heading">{{product.name}}</strong>
                <p>
                <h3 class="heading-xs">{{formatDate dateIn}}</h3></p>
                <hr>
                <div class="clearfix margin-bottom-10"></div>

                <div class="row margin-bottom-20">
                    <div class="col-xs-4 service-in">
                        <strong data-i18n="rfq.requestQuote">Quote</strong>
                        <h4 class="counter quote">
                            {{#if_eq_or_eq completed 'true' expired 'true'}}
                            <a id="quote-{{inc @index}}" data-i18n="[data-emptytext]profile.emptyText" data-type="text" >{{quote}}</a>
                            {{else}}
                            {{#if_eq_or_eq status 'acceptedByC' status 'rejectedByC'}}
                            <a id="quote-{{inc @index}}" data-i18n="[data-emptytext]profile.emptyText" data-type="text" >{{quote}}</a>
                            {{/if_eq_or_eq}}
                            {{#if_eq status 'pending'}}
                            <a id="quote-{{inc @index}}" data-i18n="[data-emptytext]profile.emptyText" {{#if_eq
                               currentUser
                            'supplier'}}class="editable-field" {{/if_eq}} data-type="text">{{quote}}</a>
                            {{/if_eq}}
                            {{#if_eq status 'acceptedByS'}}
                            <a id="quote-{{inc @index}}" data-i18n="[data-emptytext]profile.emptyText" {{#if_eq
                               currentUser
                            'customer'}}class="editable-field" {{/if_eq}} data-type="text">{{quote}}</a>
                            {{/if_eq}}
                            {{#if_eq status 'rejectedByS'}}
                            <a id="quote-{{inc @index}}" data-i18n="[data-emptytext]profile.emptyText" data-type="text" >{{quote}}</a>
                            {{/if_eq}}
                            {{/if_eq_or_eq}}
                            <span>€</span>

                        </h4>
                    </div>
                    <div class="col-xs-8 text-right service-in">
                        <strong data-i18n="rfq.requestQuantity">Quantity</strong>
                        <h4 class="counter quantity">
                            <form class="sky-form rfq-select-form">
                                <label class="select rfq-select-label">
                                    <select id="selectqnty-{{inc @index}}" disabled class="rfq-select">
                                        {{#each munits}}
                                        <option {{#if_eq this
                                        '--'}} {{#unless ../quantity}} selected="" {{/unless}} disabled {{/if_eq}}
                                        {{#if_eq this ../quantity.unity}} selected="" {{/if_eq}} value={{this}}
                                        data-i18n="rfq.{{this}}"></option>
                                        {{/each}}
                                    </select>
                                    <i></i>
                                </label>
                            </form>

                            {{#if_eq_or_eq completed 'true' expired 'true'}}
                            <a id="quantity-{{inc @index}}" data-i18n="[data-emptytext]profile.emptyText"
                               data-type="text">{{quantity.number}}</a>

                            {{else}}
                            {{#if_eq_or_eq status 'acceptedByC' status 'rejectedByC'}}
                            <a id="quantity-{{inc @index}}" data-i18n="[data-emptytext]profile.emptyText"
                               data-type="text" ">{{quantity.number}}</a>
                            {{/if_eq_or_eq}}
                            {{#if_eq status 'pending'}}
                            <a id="quantity-{{inc @index}}" data-i18n="[data-emptytext]profile.emptyText" {{#if_eq
                               currentUser
                            'supplier'}}class="editable-field"
                            {{/if_eq}}" data-type="text">{{quantity.number}}</a>
                            {{/if_eq}}
                            {{#if_eq status 'acceptedByS'}}
                            <a id="quantity-{{inc @index}}" data-i18n="[data-emptytext]profile.emptyText" {{#if_eq
                               currentUser
                            'customer'}}class="editable-field"
                            {{/if_eq}} data-type="text">{{quantity.number}}</a>
                            {{/if_eq}}
                            {{#if_eq status 'rejectedByS'}}
                            <a id="quantity-{{inc @index}}" data-i18n="[data-emptytext]profile.emptyText"
                               data-type="text">{{quantity.number}}</a>
                            {{/if_eq}}
                            {{/if_eq_or_eq}}


                        </h4>
                    </div>
                </div>

                <div class="statistics">

                    <h3 class="heading-xs"><span data-i18n="rfq.requestStatus"></span> <span class="status-rfq pull-right
                {{#if_eq status 'pending'}} color-info {{else}} {{#if_eq_or_eq status 'rejectedByC' status 'rejectedByS' }} color-danger {{ else }}
                color-success {{/if_eq_or_eq}} {{/if_eq}}
                " id="status-{{inc @index}}"
                                                                                             value={{status}}
                                                                                             data-i18n="rfq.{{status}}"></span>
                    </h3>

                    <hr>
                    <small><span data-i18n="rfq.requestLastModification"></span> <strong
                            id="last-modify-{{inc @index}}"> {{lastModification status
                        customer supplier}}</strong></small>


                </div>
                {{#if_eq completed false}}
                {{#if_eq expired false}}

                <div id="req-buttons-{{inc @index}}" class="request_buttons">
                    <button id="cancel-req-{{inc @index}}" class="hidden btn-u btn-u-default"
                            onclick="resetRequest('{{inc @index}}','{{quote}}','{{quantity.number}}','{{quantity.unity}}')"
                            type="button" data-i18n="rfq.requestCancel">
                    </button>
                    {{#if_eq currentUser 'supplier'}}

                    <button id="save-accept-req-{{inc @index}}" class="hidden btn-u btn-u-sea" type="button"
                            onclick="acceptBySupplier('{{_id_c}}','{{_id}}','{{inc @index}}','{{quote}}','{{quantity}}','{{supplier.name}}')"
                            data-i18n="rfq.requestSaveAccept">

                    </button>

                    <button id="accept-{{inc @index}}"
                            class="default-button {{#if_not_eq status 'pending'}} hidden {{/if_not_eq}} accept-rfq btn-u btn-u-green"
                            type="button"
                            onclick="acceptBySupplier('{{_id_c}}','{{_id}}','{{inc @index}}','{{quote}}','{{quantity}}','{{supplier.name}}')"
                            data-i18n="rfq.requestAccept">
                    </button>
                    <button id="reject-{{inc @index}}"
                            class="default-button {{#if_not_eq status 'pending'}} hidden{{/if_not_eq}} reject-rfq btn-u btn-u-red"
                            type="button"
                            onclick="rejectedBySupplier('{{_id_c}}','{{_id}}','{{inc @index}}','{{supplier.name}}')"
                            data-i18n="rfq.requestReject">
                    </button>

                    {{else}}
                    <button id="save-accept-req-{{inc @index}}" class="hidden btn-u btn-u-sea" type="button"
                            onclick="modifyByCustomer('{{_id_c}}','{{_id}}','{{inc @index}}','{{customer.name}}')"
                            data-i18n="rfq.requestSave">
                    </button>

                    <button id="accept-{{inc @index}}"
                            class="default-button {{#if_not_eq status 'acceptedByS'}} hidden  {{/if_not_eq}} accept-rfq btn-u btn-u-green"
                            type="button"
                            onclick="acceptByCustomer('{{_id_c}}','{{_id}}','{{inc @index}}','{{customer.name}}')"
                            data-i18n="rfq.requestConfirm">

                    </button>
                    <button id="reject-{{inc @index}}"
                            class="default-button  {{#if_not_eq status 'acceptedByS'}} hidden  {{/if_not_eq}} reject-rfq btn-u btn-u-red"
                            type="button"
                            onclick="rejectedByCustomer('{{_id_c}}','{{_id}}','{{inc @index}}','{{customer.name}}')"
                            data-i18n="rfq.requestGiveup">
                    </button>
                    {{/if_eq}}
                </div>
                {{/if_eq}}
                {{/if_eq}}

                <small id="unsaved_{{inc @index}}" class="hidden">Change Unsaved</small>
            </div>
        </div>


    </div>
    <!-- /.panel-body -->
    <!-- <div class="panel-footer">
        <div class="input-group">
        <input id="rfq-input-msg" type="text" class="form-control input-sm" data-i18n="[placeholder]rfq.writeMessage">
        <span class="input-group-btn">
        <button class="btn btn-warning btn-sm" id="btn-chat" onclick="sendMessage('{{_id}}')" data-i18n="buttons.send">
        </button>
        </span>
        </div>
        </div>
        /.panel-footer -->


</script>

<!--Template RFQ Message -->
<script id="rfq_new_message_template" type="text/x-handlebars-template">
    <li class="{{#if_eq type 'customer'}}left{{else}}right{{/if_eq}} clearfix">
                    <span class="chat-img {{#if_eq type 'customer'}}pull-left{{else}}pull-right{{/if_eq}}">
                    <img src="{{sender.logo}}" alt="User Avatar" class="img-circle">
                    </span>
        <div class="chat-body clearfix">
            <div class="header">
                <strong class="{{#if_eq type 'supplier'}}pull-right{{/if_eq}} primary-font">{{sender.name}}</strong>
                <small class="{{#if_eq type 'customer'}}pull-right{{/if_eq}} text-muted">
                    <i class="fa fa-clock-o fa-fw"></i> {{formatDate dateIn}}
                </small>
            </div>
            <p>
                {{text}}
            </p>
        </div>
    </li>
</script>
<!--End Template RFQ Message -->

<!--Template RFQ Message Auto-->

<script id="rfq_new_message_auto_template" type="text/x-handlebars-template">
    <div class="rfq-notify alert {{#if_eq link.info "accepted"}} alert-success
    {{else}} {{#if_eq link.info "pending"}} alert-info{{else}} alert-danger {{/if_eq}} {{/if_eq}} fade in
    alert-dismissable">
    <!--<button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>-->
    <a class="alert-link" href="#accordion-{{link.url}}" onclick="openRequest({{link.url}})"><strong type="text"
                                                                                                     data-i18n="warning"></strong>
        <span type="text" data-i18n="{{text}}">{{text}} </span> {{link.url}}</a>
    </div>

</script>
<!--End Template RFQ Message Auto-->


<!--Template RFQ New Request-->

<script id="rfq_new_request_template" type="text/x-handlebars-template">

    <section>
        <label class="select">
            <select id="product-list-rfq" name="product">
                {{#each products}}
                <option value={{this._id}}>{{this.name}}</option>
                {{/each}}
            </select>
            <i></i>
        </label>
    </section>
    <!--  </div>-->

    <div class="row">
        <section class="col col-4">
            <label class="input">
                <i class="icon-append fa  fa-briefcase"></i>
                <input type="text" name="quantity" id="new-qnty" data-i18n="[placeholder]rfq.requestQuantity">
            </label>
        </section>
        <section class="col col-2">
            <label class="select">
                <select id="new-qnty-unity" name="measurement" disabled>
                    {{#each munits}}
                    <option value={{this}} data-i18n="rfq.{{this}}"></option>
                    {{/each}}

                </select>
                <i></i>
            </label>
        </section>
        <section class="col col-6">
            <label class="input">
                <i class="icon-append fa fa-eur"></i>
                <input type="text" name="quote" id="new-quote" data-i18n="[placeholder]rfq.requestQuote">
            </label>
        </section>

    </div>
</script>
<!--End Template RFQ New Request-->


</body>
</html>
